<app-please-wait [pleaseWaitActive]="pleaseWaitActive"></app-please-wait>
<div class="row">
  <div class="col s12 m12">
    <div class="card blue-grey darken-1 white-text">
      <a class="btn-flat white-text" routerLink="/home">Home</a>
      <div class="card-content">
        <span class="card-title">
          <h5 class="left text-beauty">Sales Invoice</h5>
        </span>
        <div class="row">
          <div class="col s12 m12">
            <div class="row">
              <div class="col s6 m6">
                <div class="input-field">
                  <input placeholder="" id="customer" type="text" [(ngModel)]="customer" appFindCustomer
                         [customerName]="customer"
                         (customers)="onCustomerFilter($event)" class="invoice-form">
                  <span class="pull-right button-search hide-on-large-only" appFindCustomer
                        [customerName]="customer"
                        (customers)="onCustomerFilter($event)"><i class="fa fa-search"></i></span>
                  <label for="customer" class="active">Customer</label>
                </div>
                <div class="row">
                  <div class="col s12">
                    <div class="input-field">
                      <input type="text" placeholder="" id="custAddress1" [(ngModel)]="customerAddress1"
                             class="invoice-form">
                      <label for="custAddress1" class="active">Address</label>
                    </div>
                    <div class="input-field">
                      <input type="text" placeholder="" id="custAddress2" [(ngModel)]="customerAddress2"
                             class="invoice-form">
                      <label for="custAddress2" class="active"></label>
                    </div>
                    <div class="input-field">
                      <input type="text" placeholder="" id="custAddress3" [(ngModel)]="customerAddress3"
                             class="invoice-form">
                      <label for="custAddress3" class="active"></label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col s4 m2 offset-s2 offset-m4">
                <div class="input-field">
                  <input placeholder="" id="invoiceDate" type="text" [(ngModel)]="invoiceDate" class="invoice-form"
                         readonly="true">
                  <label for="invoiceDate" class="active">Date</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        <br/>
        <div class="row">
          <div class="col s12 m12">
            <table *ngIf="!smallWindow">
              <thead>
              <tr>
                <th style="text-align: center">Qty</th>
                <th>Item</th>
                <th style="text-align: right">Unit Price</th>
                <th style="text-align: right">Discount</th>
                <th style="text-align: right">Total Price</th>
              </tr>
              </thead>
              <tbody>
              <tr class="collection-item" *ngFor="let i of salesDetails">
                <td style="width:8%;" (appTabNewRow)="onAddRow($event)" appTabDelRow [rowId]="i.id"
                    (rowDelAllowed)="onRemoveRow($event)">
                  <input type="text" style="text-align: center" [(ngModel)]="i.productQty"
                         [appNumberFormat]="i.productQty"
                         class="invoice-form-detail invoice-form">
                </td>
                <td style="width:50%" (appTabNewRow)="onAddRow($event)" appTabDelRow [rowId]="i.id"
                    (rowDelAllowed)="onRemoveRow($event)">
                  <input type="text" [(ngModel)]="i.productName" appFindProduct
                         [productName]="i.productName"
                         (products)="onProductFilter(i,$event)"
                         class="invoice-form-detail invoice-form">
                  <span class="pull-right button-search hide-on-large-only" appFindProduct
                        [productName]="i.productName"
                        (products)="onProductFilter(i,$event)"><i class="fa fa-search"></i></span>
                </td>
                <td style="width:12%;" (appTabNewRow)="onAddRow($event)" appTabDelRow [rowId]="i.id"
                    (rowDelAllowed)="onRemoveRow($event)">
                  <input type="text" style="text-align: right" [appNumberFormat]="i.unitPrice" [(ngModel)]="i.unitPrice"
                         class="invoice-form-detail invoice-form">
                </td>
                <td style="width:5%;" (appTabNewRow)="onAddRow($event)" [appNumberFormat]="i.discount" appTabDelRow
                    [rowId]="i.id"
                    (rowDelAllowed)="onRemoveRow($event)">
                  <input type="text" style="text-align: right" [(ngModel)]="i.discount"
                         class="invoice-form-detail invoice-form">
                </td>
                <td style="width:25%;" #itemtotalPrice (appTabNewRow)="onAddRow($event)" appTabDelRow [rowId]="i.id"
                    (rowDelAllowed)="onRemoveRow($event)">
                  <input type="text" style="text-align: right" [value]="calculatedPrice(i)"
                         class="invoice-form-detail invoice-form" readonly="true">
                </td>
              </tr>
              </tbody>
            </table>
            <table *ngIf="smallWindow">
              <thead>
              <tr>
                <th style="text-align: center">Detail</th>
              </tr>
              </thead>
              <tbody>
              <tr class="collection-item" *ngFor="let i of salesDetails">
                <td>
                  <div>
                    <div class="input-field" (appTabNewRow)="onAddRow($event)" appTabDelRow [rowId]="i.id"
                         (rowDelAllowed)="onRemoveRow($event)">
                      <input type="text" [(ngModel)]="i.productName" appFindProduct
                             [productName]="i.productName"
                             (products)="onProductFilter(i,$event)"
                             class="invoice-form" placeholder="">
                      <span class="pull-right button-search hide-on-large-only" appFindProduct
                            [productName]="i.productName"
                            (products)="onProductFilter(i,$event)"><i class="fa fa-search"></i></span>
                      <label class="active">Item</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col s3">
                      <div class="input-field" (appTabNewRow)="onAddRow($event)" appTabDelRow [rowId]="i.id"
                           (rowDelAllowed)="onRemoveRow($event)">
                        <input type="text" style="text-align: center" [(ngModel)]="i.productQty"
                               [appNumberFormat]="i.productQty"
                               class="invoice-form" placeholder="">
                        <label class="active">Qty</label>
                      </div>
                    </div>
                    <div class="col s3">
                      <div class="input-field" (appTabNewRow)="onAddRow($event)" appTabDelRow [rowId]="i.id"
                           (rowDelAllowed)="onRemoveRow($event)">
                        <input type="text" style="text-align: right" [appNumberFormat]="i.unitPrice"
                               [(ngModel)]="i.unitPrice"
                               class="invoice-form" placeholder="">
                        <label class="active">Unit Price</label>
                      </div>
                    </div>
                    <div class="col s3">
                      <div class="input-field" (appTabNewRow)="onAddRow($event)" [appNumberFormat]="i.discount"
                           appTabDelRow
                           [rowId]="i.id"
                           (rowDelAllowed)="onRemoveRow($event)">
                        <input type="text" style="text-align: right" [(ngModel)]="i.discount"
                               class="invoice-form"placeholder="">
                        <label class="active">Disc</label>
                      </div>
                    </div>
                    <div class="col s3">
                      <div class="input-field" #itemtotalPrice (appTabNewRow)="onAddRow($event)" appTabDelRow
                           [rowId]="i.id"
                           (rowDelAllowed)="onRemoveRow($event)">
                        <input type="text" style="text-align: right" [value]="calculatedPrice(i)"
                               class="invoice-form" readonly="true" placeholder="">
                        <label class="active">Total</label>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div style="border-top:1px solid lightgray; width: 100%"></div>
        <div class="row">
          <div class="col s5 offset-s7 m3 offset-m9">
            <div class="input-field" style="padding-right:5px;">
              <input type="text" id="total" placeholder="0" style="text-align: right" value="{{invoiceTotal}}"
                     class="invoice-form" readonly="true">
              <label for="total" class="active">Total</label>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col s5 offset-s7 m3 offset-m9">
            <div class="input-field" style="padding-right: 5px;">
              <input type="text" id="invoiceDisc" placeholder="0" style="text-align: right"
                     [(ngModel)]="invoiceDiscount"
                     [appNumberFormat]="invoiceDiscount"
                     class="invoice-form" value="0">
              <label for="invoiceDisc" class="active">Discount</label>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col s5 offset-s7 m3 offset-m9">
            <div class="input-field" style="padding-right: 5px;">
              <input type="text" id="grandTotal" placeholder="0" style="text-align: right" readonly='true'
                     class="invoice-form" value="0" [(ngModel)]="invoiceGrandTotal">
              <label for="grandTotal" class="active">Grand Total</label>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col s5 offset-s7 m3 offset-m9">
            <div class="input-field">
              <input type="checkbox" class="invoice-form" id="paidCheckbox" [(ngModel)]="salesPaidStatus"/>
              <label for="paidCheckbox">Paid</label>
            </div>
          </div>
        </div>
        <br/>
        <div class="row">
          <div class="col s9 offset-s3" style="text-align: right;">
            <div class="input-field">
              <button type="button" class="btn orange lighten-2 action-button" (click)="onResetInvoice()">Reset</button>
              <button type="button" class="btn orange lighten-2 action-button" (click)="goToList()">Cancel</button>
              <button type="button" class="btn orange darken-1 action-button" (click)="onCreateInvoice()">Save</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div id="customerModal" class="modal">
  <div class="modal-content">
    <h4>Customer List</h4>
    <ul class="collection">
      <li class="collection-item" *ngFor="let cust of customers" (click)="onPickCustomer(cust)" style="cursor: pointer">
        <div>{{cust.customerName}} ({{cust.customerNickName}})</div>
        <div>{{cust.customerAddress1}}</div>
      </li>
    </ul>
  </div>
</div>
<div id="productModal" class="modal">
  <div class="modal-content">
    <h4>Product List</h4>
    <ul class="collection">
      <li class="collection-item" *ngFor="let prod of products" (click)="onPickProduct(prod)" style="cursor: pointer">
        <div>{{prod.productName}} ({{prod.productId}})</div>
        <div>{{prod.spesification}}</div>
        <div>Last Price : {{prod.lastPrice}}, Stock : {{prod.stock}}</div>
      </li>
    </ul>
  </div>
</div>
